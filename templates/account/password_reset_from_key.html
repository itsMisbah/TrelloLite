{% extends 'base.html' %}

{% block title %}Reset Password - TaskFlow{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-6 mx-auto">
        <div class="card shadow">
            <div class="card-body p-5">

                {% if token_fail %}
                    <h1>Bad Token</h1>
                    <p>
                        This reset link is invalid or already used.
                        <a href="{% url 'account_reset_password' %}">
                            Request new reset
                        </a>
                    </p>

                {% else %}
                    <h1>Change Password</h1>

                    <form method="post" action="{{ action_url }}">
                        {% csrf_token %}
                        {{ redirect_field }}

                        <div class="mb-3">
                            <label class="form-label">New Password</label>
                            {{ form.password1 }}
                            {{ form.password1.errors }}
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Confirm Password</label>
                            {{ form.password2 }}
                            {{ form.password2.errors }}
                        </div>

                        {{ form.non_field_errors }}

                        <button type="submit"
                                class="btn btn-primary btn-lg w-100 mb-3">
                            Change Password
                        </button>

                        <button type="submit"
                                form="logout-from-stage"
                                class="btn btn-link w-100">
                            Cancel
                        </button>
                    </form>

                {% endif %}

            </div>
        </div>
    </div>
</div>

{% if not cancel_url %}
<form id="logout-from-stage"
      method="post"
      action="{% url 'account_logout' %}">
    <input type="hidden" name="next" value="{% url 'account_login' %}">
    {% csrf_token %}
</form>
{% endif %}

{% endblock %}
